parameters:
    user_provider.class: PROCERGS\VPR\CoreBundle\Security\FOSUBUserProvider
    procergs_person.registration.form.type.class: PROCERGS\VPR\CoreBundle\Form\Type\RegistrationFormType
    kernel.listener.logged_in_user_listener.class: PROCERGS\VPR\CoreBundle\EventListener\LoggedInUserListener
    procergs_vpr.listener.authentication.class: PROCERGS\VPR\CoreBundle\EventListener\AuthenticationListener

services:
    user_provider:
        class: "%user_provider.class%"
        arguments: [ "@fos_user.user_manager", { loginCidadao: loginCidadaoId } ]

    procergs_person.registration.form.type:
        class: %procergs_person.registration.form.type.class%
        arguments: [ PROCERGS\VPR\CoreBundle\Entity\Person ]
        tags:
            - { name: form.type, alias: vpr_person_registration }

    procergs_vpr.listener.authentication:
        class: %procergs_vpr.listener.authentication.class%
        arguments: [ "@fos_user.security.login_manager", %fos_user.firewall_name% ]
        #parent: fos_user.listener.authentication        
        #abstract: true
        calls:
            - [setContainer, ["@service_container"]]        
        tags:
            - { name: kernel.event_subscriber }

    kernel.listener.logged_in_user_listener:
        class: %kernel.listener.logged_in_user_listener.class%
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }
        arguments: [ "@security.context", "@router", "@session" ]
